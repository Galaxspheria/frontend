<!doctype html>
<html>
  <head>
    <title>meese</title>
    <link rel="stylesheet" href="https://unpkg.com/tachyons@4.10.0/css/tachyons.min.css" />
    <link rel="stylesheet" type="text/css" href="https://js.cit.api.here.com/v3/3.0/mapsjs-ui.css?dp-version=1533195059" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <style>
        .highlight-green, .highlight-white { display: inline; line-height: 1.5em; padding: 0.25em; position: relative; left: 0.25em; padding-left: 0; }
        .highlight-green { background: #7FD142; box-shadow: 0.25em 0 0 #7FD142, calc(0.25em*-1) 0 0 #7FD142; }
        .highlight-white { background: #FFFFFF; box-shadow: 0.25em 0 0 #FFFFFF, calc(0.25em*-1) 0 0 #FFFFFF; padding-left: 0.25em; }
        .dl-map { width: 100%; }
        .dl-map, .wiki-block { height: calc(100vh - 149px); }
        #scroller, #wikipediaBlock { display: none; animation: fadein 1s ease-out; }
        @keyframes fadein { from { opacity: 0; } to { opacity: 1; } }
    </style>
  </head>
  <body class="sans-serif">
    <nav class="db dt-l w-100 border-box pa3 ph5-l fixed shadow-1 bg-white z-2">
        <a class="db dtc-l v-mid mid-gray link w-100 w-25-l tc tl-l mb2 mb0-l" href="#" title="Home">
            <img src="/melvintext.svg" class="dib h2" alt="MEESE.io">
        </a>
        <div class="db dtc-l v-mid w-100 w-75-l tc tr-l">
            <span class="dark-gray f6 f5-l dib">Maps for Evaluation, Exploration, and Surveying of Ecosystems</span>
            <!--
            <a class="link dim dark-gray f6 f5-l dib mr3 mr4-l" href="#" title="Home">Home</a>
            <a class="link dim dark-gray f6 f5-l dib mr3 mr4-l" href="#" title="How it Works">How it Works</a>
            <a class="link dim dark-gray f6 f5-l dib mr3 mr4-l" href="#" title="Blog">Blog</a>
            <a class="link dim dark-gray f6 f5-l dib mr3 mr4-l" href="#" title="Press">Press</a>
            <a class="link dim dark-gray f6 f5-l dib" href="#" title="Contact">Contact</a>
            -->
        </div>
    </nav>
    <button id="scroller" class="fixed br-100 h2 w2 bottom-2 right-2 z-1 grow b--blue bg-blue white shadow-1"><i class="fa fa-chevron-up"></i></button>
    <header class="vh-100 bg-blue dt w-100">
        <div style="background:url(meesebg.svg) no-repeat bottom center;" class="dtc tc v-mid contain ph3 ph4-m ph5-l">
            <h1 class="f2 f-subheadline-l measure lh-title fw9 highlight-green white">Monitoring & Promoting Biodiversity</h1>
            <br/><br/><br/>
            <h2 class="f3 fw4 black highlight-white">Maps for Evaluation, Exploration, and Surveying of Ecosystems</h2>
            <br/><br/><br/>
            <button id="downScroller" class="br-100 h3 w3 f3 grow b--white bg-white blue"><i class="fa fa-chevron-down"></i></button>
        </div>
    </header>
    <div class="relative dt-l w-100 border-box pa3 ph5-l shadow-1 bg-blue z-1">
        <div class="db dtc-l v-mid w-100 w-75-l tl">
            <form id="searchForm" class="bg-blue center br2-ns">
                <div class="cf">
                    <label class="clip" for="search">Search</label>
                    <input class="f6 f5-l input-reset bn fl black-80 bg-white pa3 lh-solid w-100 w-75-m w-80-l br2-ns br--left-ns" placeholder="Search for a species" type="text" name="search" value="" id="searchField"/>
                    <input class="f6 f5-l button-reset fl pv3 tc bn bg-animate bg-black-70 hover-bg-black white pointer w-100 w-25-m w-20-l br2-ns br--right-ns" type="submit" value="Search"/>
                </div>
                </fieldset>
            </form>
        </div>
    </div>
    <div class="absolute dt left-2 wiki-block z-1">
        <div class="dtc v-mid">
            <div id="wikipediaBlock" class="pa4 bg-white shadow-1 measure-narrow overflow-scroll" style="max-height: 75%;">
                <button id="closeWiki" class="fr bg-transparent b--transparent gray"><i class="fa fa-times"></i></button>
                <h2 id="wikipediaTitle" class="f3 lh-title fw9 mb3 mt0 pt3 bb bw2">
                    title
                </h2>
                <div id="wikipediaExtract">
                    wikipedia
                </div>
            </div>
        </div>
    </div>
    <div>
        <div class="dl-map" onmouseover="document.body.style.overflow='hidden';"  onmouseout="document.body.style.overflow='auto';"></div>
        <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-core.js"></script>
        <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-service.js"></script>
        <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-ui.js"></script>
        <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-mapevents.js"></script>
        <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-clustering.js"></script>
        <script type="text/javascript" src="https://js.cit.datalens.api.here.com/latest/mapsjs-datalens.js"></script>
        <script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
        <script type="text/javascript" src="./map.js"></script>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-1.11.1.js"></script>
    <script>
        $(function () {
            var socket = io();
            $('#scroller').click(function () {
                $('html, body').animate({ scrollTop: 0 }, 'slow', function () {
                    console.log("reached top");
                });
            });
            $('#downScroller').click(function () {
                $('html, body').animate({ scrollTop: window.outerHeight }, 'slow', function () {
                    console.log("reached bottom");
                });
            });
            $('#searchForm').submit(function (event) {
                event.preventDefault();
                let query = $('#searchField').val();
                socket.emit('search', query);
            });
            document.addEventListener('scroll', function (event) {
                if (window.pageYOffset != 0) {   
                    $('#scroller').css("display", "block");
                    $('#scroller').css("position", "fixed");
                } else {
                    $('#scroller').css("display", "none");
                }
            }, true);
            $('#closeWiki').click(function () {
                $('#wikipediaBlock').css("display", "none");
            });
            socket.on('wikipedia extract', function (page) {
                if(!page.missing && page.extract != "") {
                    $('#wikipediaTitle').text(page.title);
                    $('#wikipediaExtract').html(page.extract);
                    $('#wikipediaBlock').css("display", "block");
                } else {
                    $('#wikipediaBlock').css("display", "none");
                }
            });
        });
    </script>
  </body>
</html>